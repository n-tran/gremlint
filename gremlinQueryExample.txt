g.V().as_("v").repeat(identity().as_("src").bothE().as_("e").bothV().as_("v").where(neq("src")).simplePath()).emit().filter(project("x","y","z").by(select(first, "v")).by(select(last, "v")).by(select("v").count(local)).as_("triple").coalesce(select("x","y").as_("a").select("triples").unfold().as_("t").select("x","y").where(eq("a")).select("t"),store("triples")).select("z").as_("length").select("triple").select("z").where(eq("length"))).select('e').unfold().groupCount().next()